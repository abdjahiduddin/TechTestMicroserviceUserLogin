{"version":3,"file":"AuthController.js","names":["login","req","res","next","email","body","password","Users","findOne","user","error","Error","statusCode","bcrypt","compare","isEqual","token","jwt","sign","userId","_id","toString","config","jwt_secret","expiresIn","status","json"],"sources":["../../server/controllers/AuthController.js"],"sourcesContent":["import Users from \"../models/users\";\nimport jwt from \"jsonwebtoken\";\nimport bcrypt from \"bcryptjs\";\n\nimport config from \"../config/config\";\n\nconst login = async (req, res, next) => {\n  try {\n    const email = req.body.email;\n    const password = req.body.password;\n\n    const user = await Users.findOne({ email: email });\n    if (!user) {\n      const error = new Error(\"Cannot found your email\");\n      error.statusCode = 401;\n      throw error;\n    }\n\n    const isEqual = await bcrypt.compare(password, user.password);\n    if (!isEqual) {\n      const error = new Error(\"Invalid password\");\n      error.statusCode = 401;\n      throw error;\n    }\n\n    const token = jwt.sign(\n      {\n        email: user.email,\n        userId: user._id.toString(),\n      },\n      config.jwt_secret,\n      { expiresIn: \"1h\" }\n    );\n\n    res.status(200).json({\n      token: token,\n      userId: user._id.toString(),\n    });\n  } catch (error) {\n    if (!error.statusCode) {\n      error.statusCode = 500;\n    }\n    next(error);\n  }\n};\n\nexport default {\n  login,\n};\n"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AAEA;AAEA,IAAMA,KAAK;EAAA,yFAAG,iBAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAEzBC,KAAK,GAAGH,GAAG,CAACI,IAAI,CAACD,KAAK;YACtBE,QAAQ,GAAGL,GAAG,CAACI,IAAI,CAACC,QAAQ;YAAA;YAAA,OAEfC,iBAAK,CAACC,OAAO,CAAC;cAAEJ,KAAK,EAAEA;YAAM,CAAC,CAAC;UAAA;YAA5CK,IAAI;YAAA,IACLA,IAAI;cAAA;cAAA;YAAA;YACDC,KAAK,GAAG,IAAIC,KAAK,CAAC,yBAAyB,CAAC;YAClDD,KAAK,CAACE,UAAU,GAAG,GAAG;YAAC,MACjBF,KAAK;UAAA;YAAA;YAAA,OAGSG,oBAAM,CAACC,OAAO,CAACR,QAAQ,EAAEG,IAAI,CAACH,QAAQ,CAAC;UAAA;YAAvDS,OAAO;YAAA,IACRA,OAAO;cAAA;cAAA;YAAA;YACJL,MAAK,GAAG,IAAIC,KAAK,CAAC,kBAAkB,CAAC;YAC3CD,MAAK,CAACE,UAAU,GAAG,GAAG;YAAC,MACjBF,MAAK;UAAA;YAGPM,KAAK,GAAGC,wBAAG,CAACC,IAAI,CACpB;cACEd,KAAK,EAAEK,IAAI,CAACL,KAAK;cACjBe,MAAM,EAAEV,IAAI,CAACW,GAAG,CAACC,QAAQ;YAC3B,CAAC,EACDC,kBAAM,CAACC,UAAU,EACjB;cAAEC,SAAS,EAAE;YAAK,CAAC,CACpB;YAEDtB,GAAG,CAACuB,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;cACnBV,KAAK,EAAEA,KAAK;cACZG,MAAM,EAAEV,IAAI,CAACW,GAAG,CAACC,QAAQ;YAC3B,CAAC,CAAC;YAAC;YAAA;UAAA;YAAA;YAAA;YAEH,IAAI,CAAC,YAAMT,UAAU,EAAE;cACrB,YAAMA,UAAU,GAAG,GAAG;YACxB;YACAT,IAAI,aAAO;UAAC;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAEf;EAAA,gBAtCKH,KAAK;IAAA;EAAA;AAAA,GAsCV;AAAC,eAEa;EACbA,KAAK,EAALA;AACF,CAAC;AAAA"}